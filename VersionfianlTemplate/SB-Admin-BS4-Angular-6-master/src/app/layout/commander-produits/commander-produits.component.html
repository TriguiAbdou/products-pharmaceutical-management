<div [@routerTransition]>
    <app-page-header [heading]="'Commander produits'" [icon]="'fa-table'"></app-page-header>
    <div class="jumbotron">
        <form role="form">
            <div class="card mb-3">
                <div class="card-header" style="font-weight:bold">
                    <i class="fa fa-list" style="font-size:17px"></i> Liste des produits de la pharmacie centrale   
                </div>
                <div class="card-body table-responsive">
                        <div style="text-align: center" id="a">
                            <div id="all-partie" style="border-width: 2px; border-style:solid ; text-align:center; border-color:green ; width: 60% ; display:inline-block" >
                                <br/>
                                <label style="font-weight: bold;font-size: 120%;color: green">Le prix total de la commande est (en DT):</label><br/>
                                <label style="font-weight: bold;font-size: 120%;margin-left: 5%">{{prixTotal}}</label>
                                <br/>
                                <label style="font-weight: bold;font-size: 120%;color: green">Veuillez saisir la date de livraison que vous souhaitez :</label><br/>
                                <br/>
                                <div class="input-group datepicker-input" style="width: 80%">
                                    <label style="font-weight: bold;margin-left: 30%;font-size: 105%;margin-top: 1%">La date de livraison : </label>
                                    <input class="form-control" placeholder="yyyy-mm-dd" name="date" style="margin-left: 5%;width: 20%;" [(ngModel)]="commandePasser.dateLivraison" ngbDatepicker #d="ngbDatepicker">
                                    <button class="input-group-addon" (click)="d.toggle()" type="button">
                                        <!-- <img src="img/calendar-icon.svg" style="width: 1.2rem; height: 1rem; cursor: pointer;"/> -->
                                        <span class="fa fa-calendar"></span>
                                    </button>
                                </div>
                                <br/>
                                <div style="text-align:center ">
                                    <button type="button"  class="btn btn-success btn-lg" (click)="PasserCommande();open(contents,test)"><i class="fa fa-shopping-cart" aria-hidden="true" style="margin-right: 2%"></i>Passer la commande !</button>
                                </div>
                                <ng-template #contents let-c="close" let-d="dismiss">
                                    <div class="modal-header">
                                        <h4 class="modal-title" style="margin-left: 2%"><i class="fa fa-check" aria-hidden="true" style="color: green"></i>Succés</h4>
                                        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <p>{{messageSucces}}</p>
                                    </div>
                                    <div class="modal-footer" style="margin-right: 30%">
                                        <button type="button" class="btn btn-success" (click)="c('Close click')" style="width: 40%">ok !</button>
                                    </div>
                                </ng-template>
                                <br/>  
                            </div>                                   
                        </div>
                        <br/>
                    <table class="table">
                        <thead>
                            <tr style="text-align: center">
                                <th style="width: 3%">Code<br/><label>{{messagess}}</label></th>
                                <th style="width: 20%" >Nom <br/><label>{{messagess}}</label></th>
                                <th style="width: 20%">Generique<br/><label>{{messagess}}</label></th>
                                <th style="width: 20%">Date fin consommation<br/><label>{{messagess}}</label></th>
                                <th style="width: 20%">Prix unitaire (DT)<br/><label>{{messagess}}</label></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="text-align: center" *ngFor="let produitpharmacie of produitspharmacies">
                                <th >{{produitpharmacie.produit.code}}</th>
                                <td >{{produitpharmacie.produit.nom}}</td>
                                <td >{{produitpharmacie.produit.generique}}</td>
                                <td >{{produitpharmacie.dfc}}</td>
                                <td >{{produitpharmacie.prixVente}}</td>
                                <td>         
                                    <button class="btn btn-success" (click)="opennn(content,produitpharmacie.produit.nom,produitpharmacie)"><i class="fa fa-shopping-cart" aria-hidden="true" style="margin-right: 4%"></i>Commander</button>
                                    <ng-template #content let-c="close" let-d="dismiss" >
                                        <div class="modal-header" >
                                            <h5 class="modal-title" style="color: rgb(42, 138, 4);font-weight: bold;margin-left: 15%">{{titrePopUp}}</h5>
                                            <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="alert alert-danger" style="text-align: center;display: none" id="msg"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                                le choix de la quantité est obligatoire!
                                            </div>
                                            <label style="margin-left: 6%;color: rgb(78, 185, 6);font-size: 105%;font-weight: bold" >Veuillez saisir la quantité que vous voulez commander :</label>
                                            <div style="text-align: center;margin-top: 4%">
                                                <label style="font-weight: bold">Quantité : </label>
                                                <input type="number" [(ngModel)]="commandeProduit.quantiteCom" name="quantite" placeholder="Quantite" style="text-align: center;margin-left: 2%" id="quantit" value=0/>
                                            </div>
                                        </div>
                                        <div class="modal-footer" style="margin-right: 18%">
                                            <button type="button" class="btn btn-success" (click)="CommandePro(produitpharmacie,contents,test,c)" style="width: 65%;margin-left: 40%"><i class="fa fa-shopping-cart" aria-hidden="true" style="margin-right: 4%"></i> Ajouter au panier</button>
                                        </div>
                                    </ng-template>
                                </td>
                            </tr>
                        </tbody> 
                    </table>     
                </div>
            </div>
        </form>
    </div>
</div>
